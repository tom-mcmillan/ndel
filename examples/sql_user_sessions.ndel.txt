# NDEL description for examples/sql_user_sessions.sql
pipeline "sql_pipeline":
  datasets:
    - name: events
      source: events
  transformations:
    - name: join_events
      kind: join
      description: join events on event_type = 'session_start'
      inputs:
        - events
      outputs:
        - events
    - name: sql_where_filter
      kind: filter
      description: filter rows with condition: event_type = 'session_start' AND event_date >= CURRENT_DATE - INTERVAL '30' DAY
      inputs:
        - events
      outputs:
        - events
    - name: sql_groupby_agg
      kind: aggregation
      description: aggregate using count grouped by user_id
      inputs:
        - events
      outputs:
        - events
    - name: sql_projection
      kind: feature_engineering
      description: compute derived columns: sessions, active_days, sessions_per_day
      inputs:
        - events
      outputs:
        - sessions
        - active_days
        - sessions_per_day
  features:
    - name: sessions
      origin: sql_projection
    - name: active_days
      origin: sql_projection
    - name: sessions_per_day
      origin: sql_projection
  models:
  metrics:
