// NDEL Fuzzy Value Resolution Examples
// Demonstrates how fuzzy values are interpreted

// ============================================================================
// FUZZY VALUE CATEGORIES
// ============================================================================

// -----------------------------
// 1. Qualitative Descriptors
// -----------------------------

performance is "excellent"     // Resolves based on metric context
quality is "poor"              // Negative qualifier
rating is "above average"      // Relative to mean

// -----------------------------
// 2. Relative Terms
// -----------------------------

age < "young"                  // Context: soccer → < 23
price is "expensive"           // Relative to market/budget
size is "large"               // Depends on what's being measured

// -----------------------------
// 3. Approximate Quantities
// -----------------------------

count approximately 100        // Allows margin of error
attendance is "packed"        // Near capacity
inventory is "low"           // Below threshold

// -----------------------------
// 4. Compound Descriptions
// -----------------------------

player is "fast technical winger"
// Resolves to: speed > 85 && technique > 80 && position IN ('LW', 'RW')

employee is "senior full-stack developer"  
// Resolves to: years_experience > 5 && skills contains ['frontend', 'backend']

// -----------------------------
// 5. Behavioral Patterns
// -----------------------------

trend shows "improving"        // Positive slope over time
pattern shows "volatile"       // High standard deviation
behavior shows "consistent"    // Low variance

// ============================================================================
// CONTEXT-DEPENDENT RESOLUTION
// ============================================================================

@domain("soccer")

// "young" means different things for different positions
goalkeeper is "young"         // Resolves to: age < 25 (keepers peak later)
striker is "young"           // Resolves to: age < 23 (forwards peak earlier)

// "tall" varies by position
defender is "tall"           // Resolves to: height > 185cm
midfielder is "tall"         // Resolves to: height > 180cm

// ============================================================================
// CONFIDENCE LEVELS
// ============================================================================

// High confidence (clear domain rules)
age < "teenager"             // [confidence: 0.95] → age < 20
temperature is "freezing"    // [confidence: 0.95] → temperature <= 0

// Medium confidence (some ambiguity)
skill is "good"              // [confidence: 0.75] → skill_rating > 7
weather is "nice"           // [confidence: 0.70] → temp: 20-25, no rain

// Low confidence (highly subjective)
style is "attractive"        // [confidence: 0.55] → varies greatly
food is "delicious"         // [confidence: 0.50] → very subjective

// ============================================================================
// RESOLUTION STRATEGIES
// ============================================================================

// Strategy 1: Domain Rules
@domain("healthcare")
blood_pressure is "high"     // Uses medical definitions → > 140/90

// Strategy 2: Statistical Analysis
performance is "outlier"     // Resolves to: > mean + 2*stddev

// Strategy 3: Historical Patterns
form is "typical"           // Based on past patterns for this entity

// Strategy 4: Machine Learning
sentiment is "positive"      // ML model classification

// Strategy 5: LLM Interpretation
description is "shows promise but needs work"  // Complex natural language

// ============================================================================
// ALTERNATIVES AND AMBIGUITY
// ============================================================================

// Multiple valid interpretations
size is "medium"
// Primary: [confidence: 0.7] → between 40 and 60
// Alternative 1: [confidence: 0.6] → equals 50
// Alternative 2: [confidence: 0.5] → between percentile(0.4) and percentile(0.6)

// Explicitly checking alternatives
if alternatives().size() > 2 then
  "Highly ambiguous - request clarification"
else
  "Proceed with primary interpretation"

// ============================================================================
// COMBINING FUZZY VALUES
// ============================================================================

// AND reduces confidence (minimum)
player is "young" && player is "talented"
// If "young" = 0.85 confidence, "talented" = 0.70 confidence
// Combined confidence = min(0.85, 0.70) = 0.70

// OR averages confidence
weather is "good" || weather is "acceptable"  
// Weighted average of confidences

// NOT preserves confidence
!(performance is "poor")
// Same confidence as the positive assertion

// ============================================================================
// FUZZY ARITHMETIC
// ============================================================================

// Fuzzy values in calculations
bonus = salary * "standard percentage"    // "standard percentage" → 0.10
days_off = "typical vacation" + sick_days // "typical vacation" → 21

// Fuzzy comparisons
if profit > "significantly higher than last year" then
  "Excellent performance"

// ============================================================================
// TEMPORAL FUZZY VALUES
// ============================================================================

// Time-relative interpretations
data from "recent"           // → last 30 days
forecast for "near future"   // → next 90 days  
happened "long ago"          // → > 2 years

// Fuzzy durations
project takes "a while"      // → 3-6 months (domain-dependent)
response in "quickly"        // → < 1 hour (context-dependent)

// ============================================================================
// LEARNING AND ADAPTATION
// ============================================================================

// System learns from usage
player is "promising"
// Initial: [confidence: 0.70] → potential > 75
// After 100 uses with feedback: [confidence: 0.85] → potential > 77 && age < 24

// User corrections improve future resolution
temperature is "hot"
// User corrects: "hot" should be > 35, not > 30
// System adapts for future queries

// ============================================================================
// DOMAIN SWITCHING
// ============================================================================

// Same term, different domains
@domain("soccer")
"veteran"                    // → age >= 30

@domain("military")  
"veteran"                    // → has_combat_experience == true

@domain("workplace")
"veteran"                    // → years_experience >= 10

// ============================================================================
// ERROR HANDLING
// ============================================================================

// Unresolvable fuzzy value
unknown_metric is "glorious"
// Error: Cannot resolve "glorious" in current context
// Suggestions: "excellent", "outstanding", "superior"

// Below confidence threshold
with_confidence(0.9, vague_term is "maybe good")
// Error: Confidence 0.45 below required 0.9
// Action: Request user clarification

// ============================================================================
// DEBUGGING FUZZY RESOLUTION
// ============================================================================

// Explain resolution
explain(player is "promising")
// Output: 
// "promising" resolved to: potential > 75
// Confidence: 0.80
// Reasoning: Based on domain rule for young players with growth
// Context: {domain: "soccer", field: "player", type: "assessment"}
// Alternatives: 
//   - "potential > 80 && age < 21" [0.65]
//   - "recent_improvement > 15%" [0.60]
